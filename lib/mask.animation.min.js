(function(t,n){"use strict";null==t&&"undefined"!=typeof global&&(t=global);var i=function(){return n(t)};if("object"==typeof exports)module.exports=i();else if("function"==typeof define&&define.amd)define(i);else{var e=i();for(var o in e)t.mask[o]=e[o]}})(this,function(){"use strict";var t=ruqq,n=t.info.cssprefix,i=t.info.prefix,e=function(){var t=document.createElement("div"),n={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},i=null;for(var o in n)if(void 0!==t.style[o]){i=n[o];break}return e=function(){return i},t=null,n=null,e()},o={prop:n+"transition-property",duration:n+"transition-duration",timing:n+"transition-timing-function",delay:n+"transition-delay"},r=function(){function t(t){var n=null;for(e.lastIndex=0;;){var i=e.exec(t);if(!i)return n;(n||(n={}))[i[1]]=i[0]}}function n(t){for(var n=Object.keys(t).sort().reverse(),i=0;n.length>i;i++)n[i]=t[n[i]];return n.join(" ")}function i(){this.transforms={}}var e=/([\w]+)\([^\)]+\)/g;return i.prototype={constructor:i,handle:function(i){var e=t(i.from),o=t(i.to),r=null;if(e){for(r in this.transforms)r in e==!1&&(e[r]=this.transforms[r]);i.from=n(e);for(r in e)this.transforms[r]=e[r]}for(r in this.transforms)r in o==!1&&(o[r]=this.transforms[r]);i.to=n(o);for(r in o)this.transforms[r]=o[r]}},i}(),s=function(){function t(t){var i=t.split(/ *\| */g),o={},r=i.length;o.prop=i[0]in e?n+i[0]:i[0];var s=i[1].split(/ *> */);if(s[0]&&(o.from=s[0]),o.to=s[s.length-1],r>2){var a=/(\d+m?s)?\s*([a-z]+[^\s]*)?\s*(\d+m?s)?/.exec(i[2]);if(null!=a)return o.duration=a[1]||"200ms",o.timing=a[2]||"linear",o.delay=a[3]||"0",o}return o.duration="200ms",o.timing="linear",o.delay="0",o}function i(n,e){this.parent=e,this.transformModel=e&&e.transformModel||new r;var o=n.model||n;if(o instanceof Array){this.model=[];for(var s=0,a=o.length;a>s;s++)this.model.push(new i(o[s],this))}else o instanceof Object?this.model=[new i(o,this)]:"string"==typeof o&&(this.model=t(o),~this.model.prop.indexOf("transform")&&this.transformModel.handle(this.model));null!=n.next&&(this.next=new i(n.next,this)),this.state=0,this.modelCount=this.model instanceof Array?this.model.length:1,this.nextCount=0,null!=this.next&&(this.nextCount=this.next instanceof Array?this.next.length:1)}var e={transform:null};return i.prototype={constructor:i,reset:function(){this.state=0,this.modelCount=this.model instanceof Array?this.model.length:1,this.nextCount=0,null!=this.next&&(this.nextCount=this.next instanceof Array?this.next.length:1);for(var t=this.model instanceof Array,n=t?this.model.length:1,i=null,e=0;t?n>e:1>e;e++)i=t?this.model[e]:this.model,i.reset&&i.reset()},getNext:function(){return 0===this.state?(this.state=1,this):(1==this.state&&this.modelCount>0&&--this.modelCount,1==this.state&&0===this.modelCount&&(this.state=2,this.next)?this.next:(2==this.state&&this.nextCount>0&&--this.nextCount,2==this.state&&0===this.nextCount&&this.parent?this.parent.getNext&&this.parent.getNext():null))}},i}(),a=function(){function n(){this.arr=[]}return n.prototype={constructor:n,put:function(n){if(null==n)return!1;var i,e,o=n.getNext();if(null==o)return!1;if(o instanceof Array){for(e=0,i=o.length;i>e;e++)this.put(o[e])===!0&&(t=!0);return t}if(0===o.state&&(o.state=1),o.model instanceof Array){for(t=!1,e=0,i=o.model.length;i>e;e++)this.put(o.model[e])===!0&&(t=!0);return t}return this.resolve(o.model.prop),this.arr.push(o),!0},resolve:function(t){for(var n,i=0,e=this.arr.length;e>i;i++)if(n=this.arr[i],n.model.prop==t)return this.arr.splice(i,1),this.put(n);return!1},getCss:function(t,n){var i,e,r,s;for(i=0,e=this.arr.length;e>i;i++){s=this.arr[i],"from"in s.model&&(t[s.model.prop]=s.model.from),n[s.model.prop]=s.model.to;for(r in o)(n[o[r]]||(n[o[r]]=[])).push(s.model[r])}for(r in o)n[o[r]]=n[o[r]].join(",")},clear:function(){this.arr=[]}},n}(),l=function(){function t(t){this.stack=new a,this.model=new s(t),this.transitionEnd=this.transitionEnd.bind(this)}var i=window.WebKitTransitionEvent||window.mozTransitionEvent||window.oTransitionEvent||window.TransitionEvent,o={display:1,"font-family":1,visibility:1};t.prototype={constructor:t,start:function(t,n){this.onComplete=n;var i={},o={};this.model.reset(),this.stack.clear(),this.stack.put(this.model),this.stack.getCss(i,o),t.addEventListener(e(),this.transitionEnd,!1),this.element=t,this.apply(i,o)},transitionEnd:function(t){if(this.stack.resolve(t.propertyName)===!0){var n={},i={};this.stack.getCss(n,i),this.apply(n,i)}else 1>this.stack.arr.length&&(this.element.removeEventListener(e(),this.transitionEnd,!1),this.onComplete&&this.onComplete())},apply:function(t,r){t[n+"transition"]="none";var s=this.element.style,a=this.element;if(null!=t)for(var l in t)s.setProperty(l,t[l],"");setTimeout(function(){var t;for(var n in r)s.setProperty(n,r[n],""),o.hasOwnProperty(n)&&(t||(t=[])).push(n);if(null!=t&&null!=i)for(var l=e(),u=0;t.length>u;u++){var f=new i(l,{propertyName:t[u],bubbles:!0,cancelable:!0});a.dispatchEvent(f)}},0)}}}(),u=function(){var t={},n=null,e=function(){n={keyframes:"@"+i+"keyframes",AnimationIterationCount:i+"AnimationIterationCount",AnimationDuration:i+"AnimationDuration",AnimationTimingFunction:i+"AnimationTimingFunction",AnimationFillMode:i+"AnimationFillMode",AnimationName:i+"AnimationName"}};return{create:function(i){if(null==n&&e(),null==t[i.id]){for(var o=document.styleSheets[0].insertRule(n.keyframes+" "+i.id+" {}",0),r=document.styleSheets[0].cssRules[o],s=i.frames-(i.frameStart||0),a=0|100/s,l=i.property||"background-position-x",u=0;s>u;u++){var f=a*(u+1)+"% { "+l+": "+-i.frameWidth*(u+(i.frameStart||0))+"px}";r.insertRule(f)}r.iterationCount=i.iterationCount,r.frameToStop=i.frameToStop,t[i.id]=r}},start:function(i,e,o){var r=i.get(0).style;r[n.AnimationName]="none",setTimeout(function(){var s=t[e];return"forwards"==r[n.AnimationFillMode]?(u.stop(i),void 0):(i.on(n+"AnimationEnd",function(){var t;if(s.frameToStop){var n=s.cssRules[s.cssRules.length-1].style;t={};for(var e=0;n.length>e;e++)t[n[e]]=n[n[e]]}u.stop(i,t)}),r[n.AnimationIterationCount]=s.iterationCount||1,r[n.AnimationDuration]=s.cssRules.length*o+"ms",r[n.AnimationTimingFunction]="step-start",r[n.AnimationFillMode]=s.frameToStop?"forwards":"none",r[n.AnimationName]=e,void 0)},0)},stop:function(t,i){var e=t.get(0).style;e[n.AnimationFillMode]="none",e[n.AnimationName]="",null!=i&&t.css(i)}}}();return{animate:function(t,n,i){new l(n).start(t,i)}}});