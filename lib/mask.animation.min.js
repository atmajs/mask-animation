!function(t,e){"use strict";null==t&&"undefined"!=typeof global&&(t=global);var n=function(){return e(t,t.mask)};if("object"==typeof exports)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else{var i=n();for(var r in i)t.mask[r]=i[r]}}(this,function(t,e){"use strict";function n(t){return t instanceof Array}function i(t){return"function"==typeof t}function r(t,e){return function(){switch(arguments.length){case 0:return e.call(t);case 1:return e.call(t,arguments[0]);case 2:return e.call(t,arguments[1]);default:return e.apply(t,arguments)}}}var s=document.createElement("div").style,o=function(){return"transform"in s?"":"webkitTransform"in s?"webkit":"MozTransform"in s?"Moz":"OTransform"in s?"O":"msTransform"in s?"ms":""}(),a=function(){for(var t=["transition","webkitTransition","MozTransition","OTransition","msTransition"],e=0,n=t.length;e<n;e++)if(t[e]in s)return!0;return!1}(),l=o?"-"+o.toLowerCase()+"-":"",u=function(){var t=(document.createElement("div"),{transition:"transitionend",OTransition:"oTransitionEnd",msTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}),e=null;for(var n in t)if(void 0!==s[n]){e=t[n];break}return(u=function(){return e})()},h={prop:l+"transition-property",duration:l+"transition-duration",timing:l+"transition-timing-function",delay:l+"transition-delay"},c=function(){function t(t){var e=null;for(i.lastIndex=0;;){var n=i.exec(t);if(!n)return e;(e||(e={}))[n[1]]=n[0]}}function e(t){for(var e=Object.keys(t).sort().reverse(),n=0;n<e.length;n++)e[n]=t[e[n]];return e.join(" ")}function n(){this.transforms={}}var i=/([\w]+)\([^\)]+\)/g;return n.prototype={constructor:n,handle:function(n){var i=t(n.from),r=t(n.to),s=null;if(i){for(s in this.transforms)s in i==!1&&(i[s]=this.transforms[s]);n.from=e(i);for(s in i)this.transforms[s]=i[s]}for(s in this.transforms)s in r==!1&&(r[s]=this.transforms[s]);n.to=e(r);for(s in r)this.transforms[s]=r[s]}},n}(),m={linear:null,ease:null,"ease-in":null,"ease-out":null,"ease-in-out":null,easeInSine:"cubic-bezier(0.47, 0, 0.745, 0.715)",easeOutSine:"cubic-bezier(0.39, 0.575, 0.565, 1)",easeInOutSine:"cubic-bezier(0.445, 0.05, 0.55, 0.95)",easeInQuad:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",easeOutQuad:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",easeInOutQuad:"cubic-bezier(0.455, 0.03, 0.515, 0.955)",easeInCubic:"cubic-bezier(0.55, 0.055, 0.675, 0.19)",easeOutCubic:"cubic-bezier(0.215, 0.61, 0.355, 1)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1)",easeInQuart:"cubic-bezier(0.895, 0.03, 0.685, 0.22)",easeOutQuart:"cubic-bezier(0.165, 0.84, 0.44, 1)",easeInOutQuart:"cubic-bezier(0.77, 0, 0.175, 1)",easeInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",easeOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",easeInOutQuint:"cubic-bezier(0.86, 0, 0.07, 1)",easeInExpo:"cubic-bezier(0.95, 0.05, 0.795, 0.035)",easeOutExpo:"cubic-bezier(0.19, 1, 0.22, 1)",easeInOutExpo:"cubic-bezier(1, 0, 0, 1)",easeInCirc:"cubic-bezier(0.6, 0.04, 0.98, 0.335)",easeOutCirc:"cubic-bezier(0.075, 0.82, 0.165, 1)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.15, 0.86)",easeInBack:"cubic-bezier(0.6, -0.28, 0.735, 0.045)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",easeInOutBack:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},f=function(){function t(t){var e=t.split(/ *\| */g),n={},i=e.length;n.prop=e[0]in u?l+e[0]:e[0];var r=e[1].split(/ *> */);if(r[0]&&(n.from=r[0]),n.to=r[r.length-1],i>2){var s=/(\d+m?s)?\s*([a-z]+[^\s]*)?\s*(\d+m?s)?/.exec(e[2]);if(null!=s)return n.duration=s[1]||"200ms",n.timing=s[2]||"linear",n.delay=s[3]||"0",n}n.duration="200ms",n.timing="linear",n.delay="0";var o=m[n.timing];return null!=o&&(n.timing=o),n}function e(i,r){this.parent=r,this.transformModel=r&&r.transformModel||new c;var s=i.model||i;if(n(s)){this.model=[];for(var o=0,a=s.length;o<a;o++)this.model.push(new e(s[o],this))}else if(s instanceof Object){if(s===i)return console.error('Animation Object Model has no "model" property',i),void(this.modelCount=this.nextCount=this.state=0);this.model=[new e(s,this)]}else"string"==typeof s&&(this.model=t(s),~this.model.prop.indexOf("transform")&&this.transformModel.handle(this.model));null!=i.next&&(this.next=new e(i.next,this)),this.state=0,this.nextCount=0,this.modelCount=n(this.model)?this.model.length:1,null!=this.next&&(this.nextCount=n(this.next)?this.next.length:1)}function r(t){for(var e=n(t),i=e?t.length:1,r=null,s=0;e?s<i:s<1;s++)r=e?t[s]:t,r.reset&&r.reset()}function s(t){return t?t.indexOf("ms")!==-1?parseInt(t):t.indexOf("s")?1e3*parseFloat(t):(console.warn("<mask:animation> parsing time",t),0):0}function o(t){for(var e=n(t),r=e?t.length:1,o=null,a=0,l=0;e?a<r:a<1;a++){o=e?t[a]:t;var u;u=i(o.getDuration)?o.getDuration():s(t.duration)+s(t.delay),u>l&&(l=u)}return l}function a(t,e){if(null!=t)for(var r=n(t),s=r?t.length:1,o=null,a=0;r?a<s:a<1;a++)o=r?t[a]:t,i(o.getFinalCss)?o.getFinalCss(e):e[o.prop]=o.to}var u={transform:null};return e.prototype={constructor:e,reset:function(){this.state=0,this.nextCount=0,this.modelCount=n(this.model)?this.model.length:1,null!=this.next&&(this.nextCount=n(this.next)?this.next.length:1),this.model&&r(this.model),this.next&&r(this.next)},getNext:function(){return 0===this.state?(this.state=1,this):(1===this.state&&this.modelCount>0&&--this.modelCount,1===this.state&&0===this.modelCount&&(this.state=2,this.next)?this.next:(2===this.state&&this.nextCount>0&&--this.nextCount,2===this.state&&0===this.nextCount&&this.parent?this.parent.getNext&&this.parent.getNext():null))},getDuration:function(){var t=0;return this.model&&(t+=o(this.model)),this.next&&(t+=o(this.next)),t},getFinalCss:function(t){return null==t&&(t={}),a(this.model,t),a(this.next,t),t}},e}(),d=function(){function t(){this.arr=[]}return t.prototype={constructor:t,put:function(t){if(null==t)return!1;var e,i,r=t.getNext(),s=!1;if(null==r)return!1;if(n(r)){for(i=0,e=r.length;i<e;i++)this.put(r[i])===!0&&(s=!0);return s}if(0===r.state&&(r.state=1),r.model instanceof Array){for(s=!1,i=0,e=r.model.length;i<e;i++)this.put(r.model[i])===!0&&(s=!0);return s}return this.resolve(r.model.prop),this.arr.push(r),!0},resolve:function(t){for(var e,n=0,i=this.arr.length;n<i;n++)if(e=this.arr[n],e.model.prop===t)return this.arr.splice(n,1),this.put(e);return!1},getCss:function(t,e){var n,i,r,s;for(n=0,i=this.arr.length;n<i;n++){s=this.arr[n],"from"in s.model&&(t[s.model.prop]=s.model.from),e[s.model.prop]=s.model.to;for(r in h)(e[h[r]]||(e[h[r]]=[])).push(s.model[r])}for(r in h)e[h[r]]=e[h[r]].join(",")},clear:function(){this.arr.length=0}},t}(),p=function(){function t(t){this.stack=new d,this.model=new f(t),this.duration=this.model.getDuration(),this._transitionEnd=r(this,this._transitionEnd),this.finish=r(this,this.finish),this.finishTimeout=null}for(var e,n,s=["WebKitTransitionEvent","mozTransitionEvent","oTransitionEvent","TransitionEvent"],o=0;o<s.length;o++)if(s[o]in window){n=s[o],e=window[n];break}null==n&&(n="TransitionEvent");var h={display:1,"font-family":1,visibility:1};try{new e(u(),{propertyName:"opacity",bubbles:!0,cancelable:!0})}catch(t){e=function(t,e){var i=document.createEvent(n),r="init"+n[0].toUpperCase()+n.substring(1);return i[r](u(),!0,!0,e.propertyName,0),i}}return t.prototype={constructor:t,start:function(t,e){if(this.element=t,a===!1)return this.apply(this.model.getFinalCss()),void(e&&e());t.addEventListener(u(),this._transitionEnd,!1);var n={},i={};this.onComplete=e,this.model.reset(),this.stack.clear(),this.stack.put(this.model),this.stack.getCss(n,i),this.apply(n,i),this.finishTimeout=setTimeout(this.finish,this.duration)},stop:function(){this.finish()},finish:function(){if(null!=this.element){this.element.style.setProperty(l+"transition","none"),this.element.removeEventListener(u(),this._transitionEnd,!1);var t=this.onComplete;this.onComplete=null,this.element=null,i(t)&&t()}},_transitionEnd:function(t){if(t.target===t.currentTarget&&this.stack.resolve(t.propertyName)===!0){var e={},n={};return this.stack.getCss(e,n),void this.apply(e,n)}},apply:function(t,n){t[l+"transition"]="none";var i=this.element.style,r=this.element;if(null!=t)for(var s in t)i.setProperty(s,t[s],"");getComputedStyle(r).width;var o;for(var s in n)i.setProperty(s,n[s],""),h.hasOwnProperty(s)&&(o||(o=[])).push(s);if(null!=o&&null!=e)for(var a=u(),c=0;c<o.length;c++){var m=new e(a,{propertyName:o[c],bubbles:!0,cancelable:!0});r.dispatchEvent(m)}}},t}(),v=function(){var t={},e=null,n=function(){e={keyframes:"@"+l+"keyframes",AnimationIterationCount:o+"AnimationIterationCount",AnimationDuration:o+"AnimationDuration",AnimationTimingFunction:o+"AnimationTimingFunction",AnimationFillMode:o+"AnimationFillMode",AnimationName:o+"AnimationName"}};return{create:function(i){if(null==e&&n(),null==t[i.id]){for(var r=document.styleSheets[0].insertRule(e.keyframes+" "+i.id+" {}",0),s=document.styleSheets[0].cssRules[r],o=i.frames-(i.frameStart||0),a=100/o,l=i.property||"background-position-x",u=0;u<o;u++){var h=a*(u+1)+"% { "+l+": "+-i.frameWidth*(u+(i.frameStart||0))+"px}";s.insertRule(h)}s.iterationCount=i.iterationCount,s.frameToStop=i.frameToStop,t[i.id]=s}},start:function(n,i,r){var s=n.style;s[e.AnimationName]="none",setTimeout(function(){var o=t[i];return"forwards"===s[e.AnimationFillMode]?void v.stop(n):(n.addEventListener(e+"AnimationEnd",function(){var t;if(o.frameToStop){var e=o.cssRules[o.cssRules.length-1].style;t={};for(var i=0;i<e.length;i++)t[e[i]]=e[e[i]]}v.stop(n,t)},!1),s[e.AnimationIterationCount]=o.iterationCount||1,s[e.AnimationDuration]=o.cssRules.length*r+"ms",s[e.AnimationTimingFunction]="step-start",s[e.AnimationFillMode]=o.frameToStop?"forwards":"none",void(s[e.AnimationName]=i))},0)},stop:function(t,n){var i=t.style;i[e.AnimationFillMode]="none",i[e.AnimationName]="",null!=n&&$(t).css(n)}}}();return function(){function t(r){if(null==r)return null;if(r instanceof Array){if(1===r.length)return t(r[0]);for(var s,o=r,a=i(o),l=new a,u=0,h=o.length;u<h;u++)s=o[u],a!==Array?a===Object&&(l[n(s)]=t(s.nodes)):l.push(t(s));return l}if(e.Dom.TEXTNODE===r.type)return r.content;if(e.Dom.FRAGMENT===r.type)return t(r.nodes);if(e.Dom.NODE){var c={};return c[n(r)]=t(r.nodes),c}return null}function n(t){var e=t.tagName;return 64===e.charCodeAt(0)?e.substring(1):e}function i(t){for(var n,i={},r=0,s=t.length;r<s;r++)switch(n=t[r],n.type){case e.Dom.TEXTNODE:case e.Dom.FRAGMENT:return Array;case e.Dom.NODE:if(1===i[n.tagName])return Array;i[n.tagName]=1}return Object}var s=e.Compo,o=1,a=2,l=e.class.create({meta:{template:"merge"},state:o,repeat:1,step:1,delayTimer:null,slots:null,pipes:null,attr:null,render:function(e,n,i){var r=this.nodes;if(null==r)return void console.warn("No Animation Model");var o=this.attr["x-slots"];if(null!=o){o=o.split(";"),this.slots={};for(var a=o.length,l=-1;++l<a;){var u=o[l].trim();this.slots[u]=this.startFromSlot}}var h=this.attr["x-pipes"];if(null!=h){h=h.split(";"),this.pipes={};for(var a=h.length,l=-1;++l<a;){var u=h[l].trim(),c=u.indexOf(".");if(c!==-1){var m=u.substring(0,c);(this.pipes[m]||(this.pipes[m]={}))[u.substring(++c)]=this.startFromPipe}else console.error("Animation - pipeName.slotName : dot not found")}s.pipe.addController(this)}for(var a=r.length,l=-1;++l<a;){var f=r[l];if("function"===f.tagName){if(null==f.compile){console.error("Please update MaskJS to compile fns inside Animation compo");break}var d=f.compile();this[f.name]=d}}this.model=new p(t(r)),this.container=i,this.attr["x-repeat"]&&(this.repeat=this.attr["x-repeat"]<<0||1/0),this.attr["x-autostart"]&&(this.slots=this.slots||{},this.slots.domInsert=this.start.bind(this))},startFromSlot:function(t,e){var n=e instanceof Node?e:null;this.start(null,n)},startFromPipe:function(t){var e=t instanceof Node?t:null;this.start(null,e)},start:function(t,e){this.delayTimer&&clearTimeout(this.delayTimer);var n=this.attr["x-delay"];return null!=n?(this.delayTimer=setTimeout(this._start.bind(this,t,e),n<<0),this):(this._start(t,e),this)},_start:function(t,e){this.state===a&&this.stop(),this.element=e||this.container,this.state=a,this.callback=t,this.step=1,this.model.start(this.element,r(this,this.nextStep))},stop:function(){this.callback&&this.callback(this),this.model.stop(),this.element=null,this.callback=null,this.state=o},nextStep:function(){return++this.step>this.repeat?this.stop():void this.model.start(this.element,r(this,this.nextStep))},dispose:function(){this.state!==o&&(this.model.onComplete=null,this.model.stop(),this.element=null,this.callback=null)}});e.registerHandler(":animation",l),e.registerHandler("Animation",l),s.prototype.animate=function(t,e,n){var i=this.find("#"+t);return null==i?(console.warn("Animation is not found",t),void(e&&e())):i.start(e,n)}}(),function(){function t(){}e.registerHandler(":animation:sprite",t),t.prototype={constructor:t,render:function(t,e,n){var i=this.attr,r=i.src,s=i.id,o=i.frames,a=i.property,l=i.frameWidth,u=i.frameHeight,h=i.iterationCount,c=i.msperframe,m=i.delay,f=(n.getAttribute("style")||"")+";background: url("+r+") 0 0 no-repeat; width:"+l+"px; height:"+u+"px;";n.setAttribute("style",f),v.create({id:s,frameWidth:l,frames:o,property:a,iterationCount:h,delay:m}),i.autostart&&v.start(n,s,c)}}}(),{animate:function(t,e,n){new p(e).start(t,n)},sprite:v}});
//# sourceMappingURL=mask.animation.min.js.map